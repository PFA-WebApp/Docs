# Umsetzung {#implementation}

Die folgenden Abschnitte stellen die Umsetzung der Web-Applikation sowohl aus der anwendungsorientierten als auch der technikorienten Sichtweise dar.

## Anwendungsorientierte Sichtweise

Die Web-Applikation ist ein Dashboard. Dieses besitzt eine Sidebar, eine Navbar und einen Body.

```{r, echo=FALSE, fig.cap="Übersicht über das Dashboard"}
knitr::include_graphics("./img/app_overview.png")
```

### Sidebar

In der Sidebar kann über einen Reiter die Funktionalität ausgewählt werden, die im Body dargestellt wird. Die Anzahl an Auswahlmöglichkeiten hängt vom Anmeldestatus und der Benutzerrolle ab.

### Navbar

Die Navbar enthält:

* einen Link zum GitHub-Repository, das den Quellcode der Web-Applikation enthält,
* einen Reload-Button, mit dem eine Aktualisierung der Daten erzwungen werden kann,
* einen Toggle, mit dem zwischen Tag- und Nachtmodus gewechselt werden kann.

### Anmeldung

Dieser Reiter verändert sich in Abhängigkeit des Anmeldestatus.

#### Status: Nicht angemeldet

```{r, echo=FALSE, fig.cap="Anmeldung - nicht angemeldet"}
knitr::include_graphics("./img/login_mask.png")
```

Registrierte Benutzer können sich durch Angabe ihres Benutzernamens und ihres Passwortes anmelden. Nicht-registrierte Benutzer müssen sich von einem Moderator oder Administrator (Wissenschaftliche Mitarbeiter) registrieren lassen.

#### Status: Angemeldet

```{r, echo=FALSE, fig.cap="Anmeldung - angemeldet"}
knitr::include_graphics("./img/login_mask_logged.png")
```

Nach erfolgreicher Anmeldung wird der Benutzer mit Informationen über sein Nutzungsverhalten versorgt. Dargestellt werden:

* der Benutzername und der Benutzerstatus,
* die Dauer seit der momentanen Anmeldung,
* die Dauer seit der letzten Anmeldung,
* die Anzahl der Anmeldungen.

Benutzer können sich zudem abmelden.

### Ausleihen & Zurückgeben

Die Ausleihe und Rückgabe setzt sich aus drei Abschnitten zusammen. Im ersten Abschnitt *Ausleihen & Zurückgeben* kann die konkrete Operation vorgenommen werden. Zusätzliche Informationen stellen die Abschnitte *Gruppen des ausgewählten Typs* und *Dateien* bereit.

```{r, echo=FALSE, fig.cap="Übersicht: Ausleihen & Zurückgeben"}
knitr::include_graphics("./img/operate_overview.png")
```

#### Ausleihen & Zurückgeben

Zunächst muss ein Typ ausgewählt werden. Wenn die Web-Applikation über einen QR-Code aufgerufen wurde, ist der zum QR-Code gehörende Typ bereits ausgewählt. Im nächsten Schritt muss ein zugehöriger Untertyp ausgewählt werden. Die konkrete Operation kann durch Klicken auf einen der verfügbaren Buttons angestoßen werden. Im sich darauf öffnenden Dialog muss die Menge angegeben und die Ausführung der Operation bestätigt werden.

`r badge("admin", short = TRUE)` Administratoren können zusätzlich den ausführenden Nutzer auswählen, um Operationen für diesen durchzuführen. Das ist zum Beispiel notwendig, wenn ein Student das Fachgebiet verlassen hat und es versäumt hat, alle ausgeliehenen Sensoren zurückzugeben.

<div class="flex">
`r operate_button("borrow")` Es können bis zur maximal verfügbaren Menge Elemente ausgeliehen werden.
</div>

<div class="flex">
`r operate_button("return")` Es können bis zur maximal ausgeliehenen Menge Elemente zurückgegeben werden.
</div>

<div class="flex">
`r operate_button("write-off")` `r badge("admin", short = TRUE)` Es können bis zur maximal im Lager verfügbaren Menge Elemente abgeschrieben werden. Dies ist zum Beispiel notwendig, wenn ein Element ausfällt oder verloren geht.
</div>

#### Gruppen des ausgewählten Typs

Alle Gruppen des ausgewählten Typs werden aufgelistet. Durch Klicken auf eine Gruppe öffnet sich ein Dialog, in dem alle Typen dieser Gruppe angezeigt werden. Durch Klicken auf einen Typen wird dieser Typ für eine weitere Operation ausgewählt. Somit können alle Elemente einer Gruppe (zum Beispiel ein Versuchsaufbau) komfortabel hintereinander ausgeliehen / zurückgegeben werden.

#### Dateien

Hier werden alle dem ausgewählten Typ zugeordneten Dateien angezeigt. Dabei ist die Anzeige in drei Reiter gegliedert:

* *Gruppen*: Alle Dateien, die Informationen zu Gruppen des ausgewählten Typs enthalten
* *Typ*: Alle Dateien, die Informationen zum ausgewählten Typ enthalten
* *Untertypen*: Alle Dateien, die Informationen zu Untertypen des ausgewählten Typs enthalten. Es ist zu beachten, dass die Wahl des Untertypen keinen Einfluss auf die angezeigten Dateien hat, da Dateien für alle Untertypen dargestellt werden.

Die Ziffer neben dem Reitertitel gibt Auskunft darüber, wie viele Dateien in der jeweiligen Kategorie vorhanden sind. Indem auf einen Dateinamen geklickt wird, öffnet sich das zugehörige PDF in einem separaten Browserfenster oder wird über den PDF-Viewer angezeigt. Alle Dateien einer Kategorie können in einem Archiv (*.zip*) heruntergeladen werden.

### Bestandsinformation

Die Bestandsinformation gliedert sich in zwei Abschnitte. In der Bestandsübersicht werden Informationen zum Lagerbestand von Sensoren dargestellt, wohingegen die Ausleihübersicht Informationen über ausgeliehene Sensoren enthält.

```{r, echo=FALSE, fig.cap="Übersicht: Bestandsinformation"}
knitr::include_graphics("./img/reporting_overview.png")
```

#### Bestandsübersicht

Zunächst muss ein Typ ausgewählt werden. Für diesen Typen werden tabellarisch alle Untertypen dieses Typs aufgelistet. Die Spalte *Verfügbar* enthält die gelagerte Menge, wohingegen die Spalte *Maximal verfügbar* die maximal gelagerte Menge (kein Sensor dieses Untertypen ausgeliehen) enthält. Über die Checkbox *Nur kritische Bestände anzeigen* kann ausgewählt werden, ob nur Untertypen angezeigt werden sollen, für die die verfügbare Menge kleiner als ihr kritischer Bestand ist. Der kritische Bestand eines Untertypen kann von einem `r badge("admin")` im Reiter *Sensortypen* festgelegt werden.

#### Ausleihübersicht

Die Ausleihübersicht besteht aus vier Reitern, die unterschiedliche Fragestellen in Bezug auf ausgeliehene Sensoren beantworten.

* *Gesamt*: Übersicht über alle Untertypen mit einer gegenwärtig ausgeliehenen Menge größer Null.
* *Nach Untertyp*: Übersicht über alle Nutzer, die den gewählten Untertypen zurzeit ausgeliehen haben. Hiermit kann herausgefunden werden, an wen man sich wenden kann, falls alle Elemente eines Untertyps ausgeliehen sind.
* *Nach Nutzer*: Übersicht über alle Untertypen, die der gewählte Nutzer zurzeit ausgeliehen hat.
* *Transaktionen*: Übersicht über alle Transaktionen, die jemals im Rahmen der Sensorverwaltung stattgefunden haben. Ein Nutzer sieht ausschließlich seine eigenen Transaktionen. Ein `r badge("admin")` sieht alle Transaktionen. Dazu gehören neben Ausleih- und Rückgabeoperationen auch Abschreibungen und sonstige Mengenänderungen.

### Nutzerverwaltung `r badge("admin", short = TRUE)` `r badge("mod", short = TRUE)`

In der *Nutzerverwaltung* können neue Nutzer hinzugefügt und in der *Nutzertabelle* verwaltet werden.

```{r, echo=FALSE, fig.cap="Übersicht: Nutzerverwaltung"}
knitr::include_graphics("./img/user_management_overview.png")
```

#### Nutzer hinzufügen

Neue Nutzer können unter Angabe eines Benutzernamens und eines zur Sicherheit zweimal anzugebenden Passwortes hinzugefügt werden. Ein `r badge("mod")` kann ausschließlich `r badge("user")` hinzufügen, wohingegen ein `r badge("admin")` Benutzer mit jeder Rolle hinzufügen kann.

#### Nutzertabelle

Die Nutzertabelle erlaubt es einem `r badge("admin")`, Nutzer zu verwalten. Neben dem Benutzernamen und dem gegenwärtigen Status gibt es drei Spalten, die Buttons enthalten, mit denen Eigenschaften eines Nutzer angepasst werden können.

* *Status ändern*: Dieser Button öffnet einen Dialog, in dem ein neuer Status für den Nutzer ausgewählt werden kann. 
* *Entfernen*: Dieser Button öffnet einen Dialog, in dem bestätigt werden muss, dass der ausgewählte Nutzer gelöscht werden soll. Es ist zu beachten, dass diese Operation nicht rückgängig gemacht werden kann. Transaktionen, die der ausgewählte Nutzer vorgenommen hat, bleiben jedoch weiterhin erhalten. Es können nur Nutzer gelöscht werden, die zurzeit keine Sensoren ausgeliehen haben. Falls der Nutzer nicht in der Lage ist, die Sensoren eigenständig zurückzugeben, kann der `r badge("admin")` die ausgeliehenen Sensoren im Reiter *Ausleihen & Zurückgeben* für diesen Nutzer zurückgeben.
* *Passwort zurücksetzen*: Dieser Button öffnet einen Dialog, in dem bestätigt werden muss, dass das Passwort des Nutzers zurückgesetzt werden soll. Das Passwort wird auf das Standardpasswort *1234* zurückgesetzt und sollte vom Nutzer sofort danach im Reiter *Einstellungen* geändert werden.

### Gruppen `r badge("admin", short = TRUE)`

Der Reiter *Gruppen* erlaubt es, neue Gruppen hinzuzufügen und bestehende Gruppen zu verwalten.

#### Gruppe hinzufügen

Eine neue Gruppe kann durch Angabe eines Gruppennames hinzugefügt werden.

#### Gruppentabelle

In der *Gruppentabelle* können Gruppen bearbeitet werden.

* *Gruppenname*: Ein Klick auf einen Gruppennamen öffnet einen Dialog, in dem der Gruppenname angepasst werden kann.
* *Typen bearbeiten*: Dieser Button öffnet einen Dialog, in dem die zur ausgewählten Gruppe zugehörigen Typen bearbeitet werden können.
* *Entfernen*: Dieser Button öffnet einen Dialog, in dem bestätigt werden muss, dass die ausgewählte Gruppe gelöscht werden soll. Es ist zu beachten, dass diese Operation nicht rückgängig gemacht werden kann.

#### Typen anzeigen

Zunächst muss eine Gruppe ausgewählt werden. In der Tabelle werden alle zur ausgewählten Gruppe zugehörigen Typen dargestellt.

### Sensortypen `r badge("admin", short = TRUE)`

Der Reiter *Sensortypen* erlaubt es, neue Typen und Untertypen hinzuzufügen und bestehende Typen und Untertypen zu verwalten.

#### Typ hinzufügen

Ein neuer Typ kann durch Angabe eines Typnamens hinzugefügt werden.

#### Typtabelle

In der *Typtabelle* können Typen bearbeitet werden.

* *Typname*: Ein Klick auf einen Typnamen öffnet einen Dialog, in dem der Typname angepasst werden kann.
* *Gruppen bearbeiten*: Dieser Button öffnet einen Dialog, in dem die zum ausgewählten Typ zugehörigen Gruppen bearbeitet werden können.
* *Entfernen*: Dieser Button öffnet einen Dialog, in dem bestätigt werden muss, dass der ausgewählte Typ gelöscht werden soll. Es ist zu beachten, dass diese Operation nicht rückgängig gemacht werden kann. Ein Typ kann nur gelöscht werden, wenn keiner seiner Untertypen ausgeliehene Elemente hat. Transaktionen, die den ausgewählten Typen betreffen, bleiben weiterhin erhalten. Das Entfernen eines Typen schließt das Entfernen aller Untertypen dieses Typen ein.

#### Gruppen anzeigen

Zunächst muss ein Typ ausgewählt werden. In der Tabelle werden alle zum ausgewählten Typen zugehörigen Gruppen dargestellt.

#### Untertypen bearbeiten

Zunächst muss ein Typ ausgewählt werden. In der Tabelle können Untertypen des ausgewählten Typen bearbeitet werden.

* *Untertypname*: Ein Klick auf einen Untertypnamen öffnet einen Dialog, in dem der Untertypname angepasst werden kann.
* *Menge*: Ein Klick auf die maximal verfügbare Menge öffnet einen Dialog, in dem die maximal verfügbare Menge des Untertypen angepasst werden kann. Es ist zu beachten, dass die maximal verfügbare Menge nicht auf einen Wert gesetzt werden kann der kleiner der Anzahl gegenwärtig ausgeliehener Elemente ist.
* *Kritischer Bestand*: Ein Klick auf den kritischen Bestand öffnet einen Dialog, in dem der kritische Bestand des Untertypen angepasst werden kann. Der kritische Bestand kann als Filterkriterium in der *Ausleihübersicht* des Reiters *Bestandsinformation* verwendet werden.
* *Entfernen*: Dieser Button öffnet einen Dialog, in dem bestätigt werden muss, dass der ausgewählte Untertyp gelöscht werden soll. Es ist zu beachten, dass diese Operation nicht rückgängig gemacht werden kann. Ein Untertyp kann nur gelöscht werden, wenn keine Elemente von diesem ausgeliehen sind. Transaktionen, die den ausgewählten Untertypen betreffen, bleiben weiterhin erhalten.

### Dateiverwaltung `r badge("admin", short = TRUE)`

In der *Dateiverwaltung* können PDF-Dateien als Informationsmaterial in den Reitern *Gruppen*, *Typen* und *Untertypen* hochgeladen werden. Die Reiter unterscheiden sich ausschließlich in der Auswahl des zu beschreibenden Objektes. Durch Klick auf *Datei hochladen*

### QR-Code `r badge("admin", short = TRUE)`

### Einstellungen

#### Benutzernamen ändern

Um den eigenen Benutzernamen zu ändern, muss ein neuer Benutzername eingeben werden. Nach Eingabe des Passworts und Bestätigen wird der Benutzername geändert.

#### Passwort ändern

Um das eigene Passwort zu ändern, muss ein neues Passwort zweimal eingegeben und bestätigt werden.

## Technikorientierte Sichtweise